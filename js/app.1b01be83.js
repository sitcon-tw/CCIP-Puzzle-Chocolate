(function(e){function t(t){for(var r,s,i=t[0],c=t[1],u=t[2],f=0,d=[];f<i.length;f++)s=i[f],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&d.push(o[s][0]),o[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(d.length)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(r=!1)}r&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},o={app:0},a=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("85ec"),o=n.n(r);o.a},"0c44":function(e,t,n){"use strict";var r=n("70b1"),o=n.n(r);o.a},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},"1f6f":function(e,t,n){"use strict";var r=n("9c34"),o=n.n(r);o.a},2:function(e,t){},2309:function(e,t,n){},"2e6b":function(e,t,n){},3:function(e,t){},4:function(e,t){},"45ff":function(e,t,n){},"490c":function(e,t,n){"use strict";var r=n("2309"),o=n.n(r);o.a},"49f8":function(e,t,n){var r={"./en.json":"edd4","./zh-TW.json":"9ea5"};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id="49f8"},"4d53":function(e,t,n){},5:function(e,t){},"55ca":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("4160"),n("b64b"),n("159b"),n("e623"),n("e379"),n("5dc8"),n("37e1");var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Header"),n("router-view"),n("Footer")],1)},a=[],s=(n("caad"),n("2532"),{name:"App",created:function(){var e=(navigator.languages[0]||navigator.language||navigator.browserLanguage).toLowerCase();e.includes("zh")||(this.$i18n.locale="en")}}),i=s,c=(n("034f"),n("490c"),n("2877")),u=Object(c["a"])(i,o,a,!1,null,null,null),l=u.exports,f=n("8c4f"),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{role:"stamp"}},[n("h1",{attrs:{role:"title"}},[e._v("攤位蓋章機")]),null!==e.boothToken&&null!==e.slug?[n("div",{attrs:{role:"booth-info"}},[n("div",{attrs:{role:"booth-logo"}},[n("img",{attrs:{src:e.boothProfile.imageUrl,alt:""}})]),n("div",{attrs:{role:"booth-displayText"}},[n("h3",[e._v(e._s(e.$t("login_as")))]),n("h1",[e._v(e._s(e.boothProfile.displayText[e.$i18n.locale]))])])])]:e._e(),e.playerToken?n("h6",{staticClass:"ma-0",attrs:{role:"detected"}},[e._v(e._s(e.$t("detected_qrcode_value_is",{value:e.playerToken.slice(0,10)+e.playerToken.slice(10).replace(/[a-z0-9]/g,"*")})))]):e._e(),n("qrcode-reader",{attrs:{noResult:!1,role:"stampScanner"},on:{success:e.onScanSuccess,error:e.onScanFail}}),n("Snackbar",{attrs:{isActive:e.showSnackbar}},[e._v(" "+e._s(e.message)+" ")])],2)},p=[],h=(n("96cf"),n("1da1")),g=n("5530"),m=n("2f62"),b=(n("d3b7"),n("bc3a")),v=n.n(b),_=n("70de"),S={baseURL:_.API_URL};Object.assign(v.a.defaults,S);var k=v.a,T=n("4328"),y=n.n(T);k.interceptors.response.use((function(e){return e}),(function(e){var t=e.response.status;switch(t/100){case 5:e.response.data={message:"Internal Server Error"};break;default:break}return Promise.reject(e)}));var E={booth:{getSlugByToken:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,k.get("/event/puzzle/deliverer",{params:{token:t}});case 2:return n=e.sent,r=n.data.slug,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),sendReward2Player:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,k.post("/event/puzzle/deliver?token=".concat(t),y.a.stringify({receiver:n}));case 2:return r=e.sent,o=r.data,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}()},player:{getUserStamps:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,k.get("/event/puzzle",{params:{token:t}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}},w=n("5118"),P={name:"Stamp",data:function(){return{boothToken:null,slug:null,playerToken:null,showSnackbar:!1,message:""}},computed:Object(g["a"])(Object(g["a"])({},Object(m["b"])(["booth"])),{},{boothProfile:function(){return this.slug&&this.booth(this.slug)||null}}),watch:{boothToken:function(e,t){var n=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(null!==e){r.next=2;break}return r.abrupt("return");case 2:if(n.message="Processing",e===t){r.next=15;break}return r.prev=4,r.next=7,E.booth.getSlugByToken(n.boothToken);case 7:n.slug=r.sent,r.next=15;break;case 10:r.prev=10,r.t0=r["catch"](4),o=r.t0.response.data.message,n.message=n.$t(o),n.toggleSnackbar();case 15:case"end":return r.stop()}}),r,null,[[4,10]])})))()},playerToken:function(e,t){var n=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!==e){t.next=2;break}return t.abrupt("return");case 2:return n.message="Processing",n.toggleSnackbar(),t.prev=4,t.next=7,E.booth.sendReward2Player(n.boothToken,n.playerToken);case 7:return t.next=9,k.get("landing?token=".concat(n.playerToken));case 9:r=t.sent,o=r.data.nickname,n.message=n.$t("sendRewardSuccess",{playerName:o,gameReward:n.$t("_stamp")}),t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](4),a=t.t0.response.data.message,n.message=n.$t(a);case 18:n.toggleSnackbar();case 19:case"end":return t.stop()}}),t,null,[[4,14]])})))()}},created:function(){this.$store.dispatch("fetchGameConfig")},mounted:function(){this.boothToken=this.$route.query.token||null},methods:{onScanSuccess:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:null===t.boothToken||null===t.boothProfile?t.boothToken=e:e!==t.boothToken&&(t.playerToken=e);case 1:case"end":return n.stop()}}),n)})))()},toggleSnackbar:function(){this.showSnackbar=!0,Object(w["setTimeout"])(function(){this.showSnackbar=!1,this.playerToken=null}.bind(this),1e4)},onScanFail:function(e){this.message=this.$t("qrcode_scan_fail"),this.toggleSnackbar()}}},O=P,R=(n("0c44"),Object(c["a"])(O,d,p,!1,null,null,null)),A=R.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{role:"reward"}},[n("h1",{attrs:{role:"GameName"}},[e._v(e._s(e.$t("reward")))]),e.showScanner?[e.showScanner?n("qrcode-reader",{attrs:{noResult:!1,title:"",subTitle:e.$t("scan_qrcode")},on:{success:e.onScanSuccess,error:e.onScanFail}}):e._e()]:e._e(),e.loggedIn?[n("h2",{attrs:{role:"got-points"}},[e._v(e._s(e.$t("has_got_points",{points:e.gotPoints})))]),n("SquareGrid",{attrs:{booths:e.boothList,userStamps:e.stamps,showAnchor:!0}}),e.description(e.$i18n.locale).length>0?n("div",{attrs:{role:"game-description"}},[e._l(e.description(e.$i18n.locale).split("\n"),(function(t,r){return[n("p",{key:r},[e._v(e._s(t))])]}))],2):e._e(),n("BoothList",{attrs:{booths:e.booths}})]:e._e(),n("Snackbar",{attrs:{isActive:e.showErrorMessage}},[e._v(" "+e._s(e.errorMessage)+" "),0===e.stamps.length?[n("button",{attrs:{role:"retry"},on:{click:e.retryScanner}},[e._v("Retry")])]:e._e()],2)],2)},C=[],M=(n("99af"),n("cb29"),n("4de4"),n("7db0"),n("d81d"),n("13d5"),{name:"Reward",computed:Object(g["a"])(Object(g["a"])({},Object(m["b"])(["description","booths","stamps","playerPubToken","errorMessage","showErrorMessage","loggedIn"])),{},{showScanner:function(){return null===this.playerPubToken},boothList:function(){var e=this,t=this.booths.map((function(t){return{isBonus:t.isBonus,significant:t.significant,slug:t.slug,displayText:t.displayText[e.$i18n.locale],imageUrl:t.imageUrl,point:t.point}})),n=Math.ceil(Math.sqrt(t.length,2)),r=n-t.length%n||0;return t.concat(Array(r).fill({isBonus:!1,significant:null,slug:null,displayText:null,imageUrl:null,point:0}))},gotPoints:function(){var e=this;return this.booths.filter((function(e){return e.isBonus})).reduce((function(e,t){return e+t.point}),0)+this.stamps.reduce((function(t,n){var r=e.booths.find((function(e){return e.slug===n.deliverer&&!1===e.isBonus}));return r&&r.point?t+r.point:t}),0)}}),created:function(){this.$store.dispatch("fetchGameConfig");var e=this.$route.query.token||null;null!==e&&(this.$store.dispatch("setPubToken",e),this.$store.dispatch("fetchPuzzleBook"))},methods:{onScanSuccess:function(e){this.$store.dispatch("setPubTokenFromToken",e),this.$store.dispatch("fetchPuzzleBook")},toggleSnackbar:function(){this.$store.dispatch("showErrorMessage")},onScanFail:function(e){this.$store.dispatch("setErrorMessage",this.$t("qrcode_scan_fail")),this.toggleSnackbar()},retryScanner:function(){this.$store.dispatch("setPubToken",null),this.toggleSnackbar()}}}),$=M,j=(n("f223"),Object(c["a"])($,x,C,!1,null,null,null)),U=j.exports,N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{role:"bingo"}},[n("h1",{attrs:{role:"GameName"}},[e._v(e._s(e.$t("bingo")))]),e.loggedIn?n("h2",{attrs:{role:"bingos"}},[e._v(e._s(e.$t("has_bingos",{bingos:e.bingos.toString()})))]):e._e(),e.showScanner?[n("qrcode-reader",{attrs:{enable:e.showScanner,noResult:!1,title:"",subTitle:e.$t("scan_qrcode")},on:{success:e.onScanSuccess,error:e.onScanFail}})]:e._e(),e.loggedIn&&e.isConfigurationCorrect?[n("SquareGrid",{attrs:{booths:e.boothList,userStamps:e.stamps,showAnchor:!0}}),e.description(e.$i18n.locale).length>0?n("div",{attrs:{role:"game-description"}},[e._l(e.description(e.$i18n.locale).split("\n"),(function(t,r){return[n("p",{key:r},[e._v(e._s(t))])]}))],2):e._e(),n("BoothList",{attrs:{booths:e.booths}})]:e._e(),e.isConfigurationCorrect?e._e():[n("div",{attrs:{role:"bingoPatternWrong"}},[n("p",[e._v(e._s(e.$t("Game configuration is not correct")))])])],n("Snackbar",{attrs:{isActive:e.showErrorMessage}},[e._v(" "+e._s(e.errorMessage)+" "),0===e.stamps.length?[n("button",{attrs:{role:"retry"},on:{click:e.retryScanner}},[e._v("Retry")])]:e._e()],2)],2)},z=[],G=(n("c740"),n("ac1f"),n("1276"),n("2ef0")),I=n.n(G),D=(n("c975"),n("fb6a"),n("1c46")),q=n.n(D);function L(e){var t=q.a.createHash("md5");return t.update(e),t.digest("hex")}function B(e){var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=e.toLowerCase().split("").filter((function(e,t,n){return n.indexOf(e)===t})).slice(0,16);while(n.length<16)n.push(t.find((function(e){return!n.includes(e)})));return n.map((function(e){return e.charCodeAt(0)>96?e.charCodeAt(0)-87:e.charCodeAt(0)-48}))}function F(e){return function(t,n){var r=B(L(t)),o=n.reduce((function(e,t){return e[t.significant]instanceof Array?e[t.significant].push(t):e[t.significant]=[t],e}),{}),a=Object.keys(o).reduce((function(e,t){var n=r.filter((function(e){return e<o[t].length}));return e[t]=o[t].map((function(e,t,r){return r[n[t%n.length]]})),e}),{});return e.split("").map((function(e){return"0"===e?{isBonus:!0}:a[e].pop()}))}}var W={name:"Bingo",computed:Object(g["a"])(Object(g["a"])({},Object(m["b"])(["description","booths","bingoPattern","stamps","playerPubToken","errorMessage","showErrorMessage","loggedIn"])),{},{isConfigurationCorrect:function(){var e=this,t=this.bingoPattern.split("").reduce((function(e,t){var n=e.find((function(e){return e.pattern===t}));return n?n.count+=1:e.push({pattern:t,count:1}),e}),[]).map((function(t){return Object.assign(t,{matched:e.booths.filter((function(e){return e.significant===t.pattern})).length})})),n=!1,r=!1;return t.forEach((function(e){"0"!==e.pattern&&(n=e.count>e.matched&&n,r=e.count<e.matched&&r)})),r&&console.warn("Some booth will missing on bingo table for some player, see situation 3, case 2, issue #2. https://github.com/CCIP-App/CCIP-Puzzle-Chocolate/issues/2"),this.bingoPattern.length>0&&!0===this.isSquareNumber(this.bingoPattern.length)&&!1===n},showScanner:function(){return null===this.playerPubToken&&this.isConfigurationCorrect},boothList:function(){var e=this;if(!1===this.isConfigurationCorrect)return[];var t=F(this.bingoPattern)(this.playerPubToken||"",this.booths.map((function(t){return{isBonus:t.isBonus,significant:t.significant,slug:t.slug,displayText:t.displayText[e.$i18n.locale],imageUrl:t.imageUrl,point:t.point}})));return t},bingos:function(){var e=this,t=this.boothList.length,n=Math.ceil(Math.sqrt(this.boothList.length,2)),r=[],o=I.a.chunk(Array(t).fill(0).map((function(e,t){return t})),n);r=r.concat(o);var a=Array(n).fill(Array(n).fill(0)).map((function(e,t){return e.map((function(e,r){return r*n+t}))}));r=r.concat(a);var s=Array(n).fill(0).map((function(e,t){return t+t*n})),i=Array(n).fill(0).map((function(e,t){return(t+1)*(n-1)}));r=r.concat([s],[i]);var c=r.map((function(t){return t.map((function(t){return{slug:e.boothList[t].slug,isBonus:e.boothList[t].isBonus}}))})),u=this.stamps.map((function(e){return e.deliverer}));return c.filter((function(e){return e.reduce((function(e,t){return(u.findIndex((function(e){return e===t.slug}))>-1||t.isBonus)&&e}),!0)})).length}}),created:function(){this.$store.dispatch("fetchGameConfig");var e=this.$route.query.token||null;null!==e&&(this.$store.dispatch("setPubToken",e),this.$store.dispatch("fetchPuzzleBook"))},methods:{isSquareNumber:function(e){return e%Math.sqrt(e,2)===0},onScanSuccess:function(e){this.$store.dispatch("setPubTokenFromToken",e),this.$store.dispatch("fetchPuzzleBook")},onScanFail:function(e){this.$store.dispatch("setErrorMessage",this.$t("qrcode_scan_fail")),this.toggleSnackbar()},toggleSnackbar:function(){this.$store.dispatch("showErrorMessage")},retryScanner:function(){this.$store.dispatch("setPubToken",null),this.toggleSnackbar()}}},H=W,Q=(n("b16c"),Object(c["a"])(H,N,z,!1,null,null,null)),K=Q.exports;r["a"].use(f["a"]);var J=new f["a"]({mode:"history",routes:[{path:"/",component:"bingo"===_["defaultMode"]?K:U},{path:"/stamp",component:A},{path:"/reward",component:U},{path:"/bingo",component:K}]}),Y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{role:"boothList"}},[e._l(e.booths,(function(t,r){return[n("div",{key:r,attrs:{role:"booth",id:t.slug}},[n("div",{attrs:{role:"logo"}},[n("img",{attrs:{src:t.imageUrl}})]),n("div",{attrs:{role:"description"}},[n("h1",[e._v(e._s(t.displayText[e.$i18n.locale]))]),n("p",[e._v(e._s(t.description[e.$i18n.locale]))])])])]}))],2)},Z=[],V={name:"BoothList",props:{booths:{type:Array,default:function(){return[]}}}},X=V,ee=(n("bc33"),Object(c["a"])(X,Y,Z,!1,null,null,null)),te=ee.exports,ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{active:e.isActive},attrs:{role:"chip"}},[n("img",{attrs:{role:"logo",src:e.logourl,alt:e.displayName}}),e._m(0)])},re=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{role:"stampImg"}},[r("img",{attrs:{src:n("7c96")}})])}],oe={name:"Chip",props:{displayName:{type:String,default:""},logoUri:{type:String,default:""},isActive:{type:Boolean,default:!1}},computed:{logourl:function(){return this.logoUri}}},ae=oe,se=(n("a0c0"),Object(c["a"])(ae,ne,re,!1,null,null,null)),ie=se.exports,ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"Footer"}},[n("div",{staticClass:"content"},[e._v(" "+e._s(e.confName)+" × OPass | Fork on "),n("a",{attrs:{href:"https://github.com/CCIP-App/CCIP-Puzzle-Chocolate/",target:"_blank",alt:"Source code on GitHub"}},[e._v("GitHub")])])])},ue=[],le={name:"Footer",computed:Object(g["a"])({},Object(m["b"])(["confName"]))},fe=le,de=(n("ee86"),Object(c["a"])(fe,ce,ue,!1,null,null,null)),pe=de.exports,he=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{role:"fragments"}},[e._l(e.fragments,(function(t,r){return[n("div",{key:r,attrs:{role:"puzzle"}},[n("div",{attrs:{role:"puzzle-name"}},[n("span",[e._v(e._s(t.puzzle))])]),n("div",{attrs:{role:"puzzle-count"}},[n("span",[e._v(e._s(t.count))])])])]}))],2)},ge=[],me={name:"FragmentList",props:{fragments:{type:Array,default:function(){return[]}}}},be=me,ve=(n("d155"),Object(c["a"])(be,he,ge,!1,null,null,null)),_e=ve.exports,Se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{role:"header"}},[e._v(" "+e._s(e.confName)+" × OPass ")])},ke=[],Te={name:"Header",computed:Object(g["a"])({},Object(m["b"])(["confName"]))},ye=Te,Ee=(n("6c3e"),Object(c["a"])(ye,Se,ke,!1,null,null,null)),we=Ee.exports,Pe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"QRScanner"}},[n("center",[""!=e.title?n("h2",{staticClass:"ma-0"},[e._v(e._s(e.title))]):e._e(),""!==e.subTitle?n("p",{attrs:{role:"subTitle"}},[e._v(e._s(e.subTitle))]):e._e(),e.noResult?e._e():n("h6",{staticClass:"ma-0",attrs:{role:"result"}},[e._v(e._s(e.result))]),e.isWebRTCSupported?[n("div",{directives:[{name:"show",rawName:"v-show",value:e.enable,expression:"enable"}],style:{width:e.previewWidth}},[n("qrcode-stream",{on:{decode:e.scannerCallback}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.enable,expression:"!enable"}]},[n("button",{staticClass:"OpenCamera",attrs:{id:"enableButton"},on:{click:e.startScanner}})])]:n("div",[n("p",[e._v("連 iOS 都支援 WebRTC 了，您是不是該換裝置了呢？")])])],2)],1)},Oe=[],Re=(n("466d"),{name:"QRScanner",props:{title:{type:String,default:""},subTitle:{type:String,default:""},show:Boolean,noResult:Boolean,width:{type:String,default:null}},data:function(){return{previewWidth:null,enable:!1,result:null}},computed:{isWebRTCSupported:function(){return!!navigator.mediaDevices},isIOS:function(){return window.navigator.userAgent.match(/iPhone|iPad|iPod/i)}},mounted:function(){this.isIOS||this.startScanner()},methods:{scannerCallback:function(e){var t=this;this.result=e,this.$emit("success",e);var n=e;setTimeout((function(e){n===t.result&&(t.result="")}),5e3)},startScanner:function(){this.isWebRTCSupported&&(this.enable=!0,this.setPreviewSize())},setPreviewSize:function(){var e=window.innerWidth,t=window.innerHeight,n=e/t;this.previewWidth=e>t?e>=1280?Math.min(Math.round((t-420)*n),1280)+"px":(this.width||Math.round(.8*e))+"px":e<=576?Math.round(.8*t*n)+"px":Math.round(.4*t*n)+"px"}}}),Ae=Re,xe=(n("b585"),Object(c["a"])(Ae,Pe,Oe,!1,null,null,null)),Ce=xe.exports,Me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{style:"--edgeLength: "+e.edgeLength,attrs:{role:"squareGrid"}},[e._l(e.booths,(function(t,r){return[e.showAnchor&&t.slug?[n("a",{key:r,attrs:{href:"#"+t.slug}},[n("Chip",{attrs:{logoUri:t.imageUrl,displayName:t.displayText,isActive:e.userStamps.findIndex((function(e){return e.deliverer===t.slug}))>-1||t.isBonus}})],1)]:[n("Chip",{key:r,attrs:{logoUri:t.imageUrl,displayName:t.displayText,isActive:e.userStamps.findIndex((function(e){return e.deliverer===t.slug}))>-1||t.isBonus}})]]}))],2)},$e=[],je={name:"SquareGrid",props:{booths:{type:Array,default:function(){return[]}},userStamps:{type:Array,default:function(){return[]}},showAnchor:{type:Boolean,default:!1}},computed:{edgeLength:function(){return Math.ceil(Math.sqrt(this.booths.length,2))}}},Ue=je,Ne=(n("1f6f"),Object(c["a"])(Ue,Me,$e,!1,null,null,null)),ze=Ne.exports,Ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{active:e.isActive},attrs:{role:"snackbar"}},[n("div",{staticClass:"wrapper"},[e._t("default")],2)])},Ie=[],De={name:"Snackbar",props:{isActive:{type:Boolean,default:!1}}},qe=De,Le=(n("bc79"),Object(c["a"])(qe,Ge,Ie,!1,null,null,null)),Be=Le.exports,Fe={BoothList:te,Chip:ie,Footer:pe,FragmentList:_e,Header:we,QrcodeReader:Ce,SquareGrid:ze,Snackbar:Be},We=(n("ddb0"),n("a925"));function He(){var e=n("49f8"),t={};return e.keys().forEach((function(n){var r=n.match(/([A-Za-z0-9-_]+)\./i);if(r&&r.length>1){var o=r[1];t[o]=e(n)}})),t}r["a"].use(We["a"]);var Qe=new We["a"]({locale:"zh-TW",fallbackLocale:"en",messages:He()}),Ke=(n("a4d3"),n("e01a"),{confName:"",title:{"zh-TW":"",en:""},description:{"zh-TW":"",en:""},bingoPattern:"",booths:[]}),Je={UPDATE_CONFIG:"UPDATE_CONFIG"},Ye={confName:function(e){return e.confName},title:function(e){return function(t){return e.title[t]||e.title.en}},description:function(e){return function(t){return e.description[t]||e.description.en}},bingoPattern:function(e){return e.bingoPattern},booths:function(e){return e.booths},booth:function(e){return function(t){return e.booths.find((function(e){return e.slug===t}))}}},Ze={fetchGameConfig:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!_["configURL"]){e.next=6;break}return e.next=3,v.a.get(_["configURL"]);case 3:n=e.sent,r=n.data,t.commit(Je.UPDATE_CONFIG,r);case 6:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},Ve={UPDATE_CONFIG:function(e,t){e.booths=t.booths,e.confName=t.confName,e.title=t.title||{en:"title undefined"},e.description=t.description||{en:"description undefined"},e.bingoPattern=t.bingoPattern}},Xe={state:Ke,getters:Ye,actions:Ze,mutations:Ve,types:Je},et={playerPubToken:null,stamps:[],fragments:[],errorMessage:null,showErrorMessage:!1,loggedIn:!1},tt={SET_TOKEN:"SET_TOKEN",UPDATE_FRAGMENT:"UPDATE_FRAGMENT",UPDATE_STAMPS:"UPDATE_STAMPS",UPDATE_ERROR_MESSAGE:"UPDATE_ERROR_MESSAGE",UPDATE_SHOW_ERROR_MESSAGE:"UPDATE_SHOW_ERROR_MESSAGE"},nt={fragments:function(e){return e.fragments},stamps:function(e){return e.stamps},playerPubToken:function(e){return e.playerPubToken},errorMessage:function(e){return e.errorMessage},showErrorMessage:function(e){return e.showErrorMessage},loggedIn:function(e){return e.loggedIn}},rt={setPubTokenFromToken:function(e,t){var n=q.a.createHash("sha1");n.update(t);var r=n.digest("hex");e.commit("SET_TOKEN",r)},setPubToken:function(e,t){e.commit("SET_TOKEN",t)},setErrorMessage:function(e,t){e.commit("UPDATE_ERROR_MESSAGE",t)},fetchPuzzleBook:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t){var n,r,o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.player.getUserStamps(t.state.playerPubToken);case 3:n=e.sent,r=n.puzzles,o=n.deliverers,t.commit("UPDATE_FRAGMENT",r||[]),t.commit("UPDATE_STAMPS",o||[]),t.commit("UDPATE_LOGIN_STATE",!0),e.next=18;break;case 10:e.prev=10,e.t0=e["catch"](0),a=e.t0.response.data.message,t.commit("UPDATE_ERROR_MESSAGE",Qe.t(a)),t.commit("UPDATE_FRAGMENT",[]),t.commit("UPDATE_STAMPS",[]),t.commit("SET_TOKEN",null),t.commit("UDPATE_LOGIN_STATE",!1);case 18:case"end":return e.stop()}}),e,null,[[0,10]])})));function t(t){return e.apply(this,arguments)}return t}(),showErrorMessage:function(e){e.commit("UPDATE_SHOW_ERROR_MESSAGE",!0)},hideErrorMessage:function(e){e.commit("UPDATE_SHOW_ERROR_MESSAGE",!1)}},ot={SET_TOKEN:function(e,t){e.playerPubToken=t},UPDATE_FRAGMENT:function(e,t){e.fragments=t},UPDATE_STAMPS:function(e,t){e.stamps=t},UPDATE_ERROR_MESSAGE:function(e,t){e.errorMessage=t,e.showErrorMessage=!0},UPDATE_SHOW_ERROR_MESSAGE:function(e){e.showErrorMessage=!e.showErrorMessage},UDPATE_LOGIN_STATE:function(e,t){e.loggedIn=t}},at={state:et,getters:nt,actions:rt,mutations:ot,types:tt};r["a"].use(m["a"]);var st=new m["a"].Store({strict:!0,modules:{Config:Xe,Puzzle:at}}),it=n("6d12"),ct=n.n(it);r["a"].config.productionTip=!1,r["a"].use(ct.a),MediaStreamTrack.prototype.getCapabilities||(MediaStreamTrack.prototype.getCapabilities=function(){}),Object.keys(Fe).forEach((function(e){r["a"].component(e,Fe[e])})),new r["a"]({router:J,store:st,i18n:Qe,render:function(e){return e(l)},mounted:function(){return document.dispatchEvent(new Event("x-app-rendered"))}}).$mount("#app")},6:function(e,t){},"6c3e":function(e,t,n){"use strict";var r=n("2e6b"),o=n.n(r);o.a},7:function(e,t){},"70b1":function(e,t,n){},"70de":function(e){e.exports=JSON.parse('{"API_URL":"https://sitcon.opass.app/","configURL":"https://play.sitcon.party/config.json"}')},"7c96":function(e,t,n){e.exports=n.p+"img/OPASS-pass-stamp.adfe341d.png"},8:function(e,t){},"840f":function(e,t,n){},"85ec":function(e,t,n){},9:function(e,t){},"9c34":function(e,t,n){},"9ea5":function(e){e.exports=JSON.parse('{"has_got_points":"已獲得 {points} 點","scan_qrcode":"請掃描 QR Code","scanner":"QR Code 掃瞄器","reward":"集章冊","bingo":"賓果冊","fragment":"碎片收集冊","sendRewardSuccess":"{gameReward} 已經發送給 {playerName}","_stamp":"戳章","_fragment":"碎片","has_bingos":"已達成 {bingos} 連線","Already take from this deliverer":"已經蓋過章囉(￣▽￣)","invalid receiver token":"條碼好像不正確(⊙ω⊙)","token and receiver required":"好像抓不到條碼(;´༎ຶД༎ຶ`)","qrcode_scan_fail":"無法識別 QR Code，請嘗試調整亮度與拍照角度試試","Game configuration is not correct":"遊戲設定檔異常，無法進行遊戲，請回報給工作人員(´・ω・`)","invalid token":"QRCode 無效(*´∀｀*)","invalid deliverer token":"攤位端網址無效，請聯絡大會人員(TдT)","Invalid token, please try again after checkin.":"你好像還沒報到，沒報到是不能參與大地遊戲的m9(＾Д＾)","Internal Server Error":"Server 好像壞了欸，快呼叫 Denny Huang　_(:3」∠)_","detected_qrcode_value_is":"偵測到 QRCode 為 {value}","login_as":"目前登入身分為"}')},a0c0:function(e,t,n){"use strict";var r=n("55ca"),o=n.n(r);o.a},b16c:function(e,t,n){"use strict";var r=n("c6e1"),o=n.n(r);o.a},b585:function(e,t,n){"use strict";var r=n("d7ca"),o=n.n(r);o.a},bc33:function(e,t,n){"use strict";var r=n("45ff"),o=n.n(r);o.a},bc79:function(e,t,n){"use strict";var r=n("ccbe"),o=n.n(r);o.a},c6e1:function(e,t,n){},ccbe:function(e,t,n){},d155:function(e,t,n){"use strict";var r=n("840f"),o=n.n(r);o.a},d7ca:function(e,t,n){},edd4:function(e){e.exports=JSON.parse('{"has_got_points":"You got {points} points","scan_qrcode":"Scan your QR Code","scanner":"QR Code Scanner","reward":"Reward Card","bingo":"Bingo Card","fragment":"Fragment Card","sendRewardSuccess":"{gameReward} has been sent to {playerName}","_stamp":"Stamp","_fragment":"fragment","has_bingos":"{bingos} bingos","Already take from this deliverer":"Already take from this deliverer","invalid receiver token":"Invalid receiver token","token and receiver required":"Token and receiver required","qrcode_scan_fail":"QRCode not found, please retry after adjust screen brightness of QRCode and photo shooting angle","Game configuration is not correct":"Game configuration is not correct. Please report this problem to staffs.","invalid token":"Invalid Token","invalid deliverer token":"Deliverer token is invalid.","Invalid token, please try again after checkin.":"Invalid token, please try again after checkin.","Internal Server Error":"Internal Server Error !!! Call Denny Huang ~~~!","detected_qrcode_value_is":"Detected QRCode value is {value}","login_as":"Login As:"}')},ee86:function(e,t,n){"use strict";var r=n("f76f"),o=n.n(r);o.a},f223:function(e,t,n){"use strict";var r=n("4d53"),o=n.n(r);o.a},f76f:function(e,t,n){}});
//# sourceMappingURL=app.1b01be83.js.map